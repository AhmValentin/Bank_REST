databaseChangeLog:
  - changeSet:
      id: create_users_table
      author: Ahmatov Valentin
      comment: Создание таблицы пользователей
      preConditions:
        - not:
            - tableExists:
                tableName: users
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: id
                  type: UUID
                  constraints:
                    primaryKey: true
                  defaultValueComputed: gen_random_uuid()
                  remarks: Уникальный идентификатор пользователя

              - column:
                  name: email
                  type: varchar(255)
                  constraints:
                    nullable: false
                    unique: true
                  remarks: Электронная почта (логин)

              - column:
                  name: phone_number
                  type: varchar(20)
                  constraints:
                    nullable: false
                    unique: true
                  remarks: Номер телефона

              - column:
                  name: first_name
                  type: varchar(100)
                  constraints:
                    nullable: false
                  remarks: Имя

              - column:
                  name: last_name
                  type: varchar(100)
                  constraints:
                    nullable: false
                  remarks: Фамилия

              - column:
                  name: role
                  type: varchar(20)
                  constraints:
                    nullable: false
                    checkConstraint: "role IN ('USER', 'ADMIN')"
                  defaultValue: "USER"
                  remarks: Роль пользователя

              - column:
                  name: birth_date
                  type: date
                  remarks: Дата рождения

  - changeSet:
      id: insert_test_users
      author: Ahmatov Valentin
      comment: Заполнение таблицы users тестовыми данными
      changes:
        - insert:
            tableName: users
            columns:
              - column: { name: email, value: "john.smith@example.com" }
              - column: { name: phone_number, value: "+79161234567" }
              - column: { name: first_name, value: "John" }
              - column: { name: last_name, value: "Smith" }
              - column: { name: birth_date, value: "1985-03-15" }

        - insert:
            tableName: users
            columns:
              - column: { name: email, value: "maria.ivanova@example.com" }
              - column: { name: phone_number, value: "+79169876543" }
              - column: { name: first_name, value: "Maria" }
              - column: { name: last_name, value: "Ivanova" }
              - column: { name: birth_date, value: "1990-07-22" }

        - insert:
            tableName: users
            columns:
              - column: { name: email, value: "alexander.petrov@example.com" }
              - column: { name: phone_number, value: "+79165554433" }
              - column: { name: first_name, value: "Alexander" }
              - column: { name: last_name, value: "Petrov" }
              - column: { name: birth_date, value: "1988-11-08" }

        - insert:
            tableName: users
            columns:
              - column: { name: email, value: "ekaterina.sidorova@example.com" }
              - column: { name: phone_number, value: "+79162223344" }
              - column: { name: first_name, value: "Ekaterina" }
              - column: { name: last_name, value: "Sidorova" }
              - column: { name: birth_date, value: "1992-05-30" }

        - insert:
            tableName: users
            columns:
              - column: { name: email, value: "admin@bank.com" }
              - column: { name: phone_number, value: "+79160000000" }
              - column: { name: first_name, value: "Admin" }
              - column: { name: last_name, value: "System" }
              - column: { name: role, value: "ADMIN" }